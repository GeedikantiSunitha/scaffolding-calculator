<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Advanced Calculator App</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background: #f5f5f5;
        height: 100vh;
        display: flex;
        overflow: hidden;
      }
      
      .sidebar {
        width: 280px;
        background: #2d2d30;
        color: white;
        display: flex;
        flex-direction: column;
        overflow-y: auto;
      }
      
      .sidebar-header {
        padding: 20px;
        border-bottom: 1px solid #3e3e42;
        display: flex;
        align-items: center;
        gap: 15px;
      }
      
      .hamburger {
        width: 20px;
        height: 20px;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        gap: 3px;
      }
      
      .hamburger span {
        width: 100%;
        height: 2px;
        background: white;
      }
      
      .sidebar-title {
        font-size: 1.2rem;
        font-weight: 600;
      }
      
      .nav-section {
        padding: 20px 0;
      }
      
      .nav-title {
        padding: 0 20px 10px;
        font-size: 0.9rem;
        font-weight: 600;
        color: #cccccc;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      
      .nav-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 20px;
        cursor: pointer;
        transition: background-color 0.2s;
        border-left: 3px solid transparent;
      }
      
      .nav-item:hover {
        background: #3e3e42;
      }
      
      .nav-item.active {
        background: #0078d4;
        border-left-color: #0078d4;
      }
      
      .nav-icon {
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
      }
      
      .nav-text {
        font-size: 0.95rem;
      }
      
      .main-content {
        flex: 1;
        display: flex;
        flex-direction: column;
        background: white;
      }
      
      .content-header {
        padding: 20px 30px;
        border-bottom: 1px solid #e1e1e1;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      
      .mode-title {
        font-size: 1.5rem;
        font-weight: 600;
        color: #323130;
      }
      
      .content-body {
        flex: 1;
        padding: 30px;
        overflow-y: auto;
      }
      
      /* Standard Calculator Styles */
      .calculator-container {
        max-width: 400px;
        margin: 0 auto;
      }
      
      .display {
        background: #2c3e50;
        color: white;
        font-size: 2.5rem;
        font-weight: 300;
        text-align: right;
        padding: 25px;
        border-radius: 15px;
        margin-bottom: 20px;
        min-height: 120px;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        justify-content: center;
        word-wrap: break-word;
        overflow-wrap: break-word;
        white-space: pre-wrap;
        line-height: 1.2;
      }
      
      .memory-controls {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        justify-content: center;
      }
      
      .memory-btn {
        background: #9b59b6;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 500;
        padding: 12px 20px;
        cursor: pointer;
        transition: all 0.2s ease;
        color: white;
        min-width: 60px;
      }
      
      .memory-btn:hover {
        background: #8e44ad;
        transform: translateY(-2px);
      }
      
      .buttons {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        grid-template-rows: repeat(6, 1fr);
        gap: 15px;
      }
      
      .btn {
        background: #ecf0f1;
        border: none;
        border-radius: 12px;
        font-size: 1.5rem;
        font-weight: 500;
        padding: 20px;
        cursor: pointer;
        transition: all 0.2s ease;
        color: #2c3e50;
      }
      
      .btn:hover {
        background: #d5dbdb;
        transform: translateY(-2px);
      }
      
      .btn:active {
        transform: translateY(0);
      }
      
      .btn.operator {
        background: #3498db;
        color: white;
      }
      
      .btn.operator:hover {
        background: #2980b9;
      }
      
      .btn.equals {
        background: #e74c3c;
        color: white;
      }
      
      .btn.equals:hover {
        background: #c0392b;
      }
      
      .btn.clear {
        background: #95a5a6;
        color: white;
      }
      
      .btn.clear:hover {
        background: #7f8c8d;
      }
      
      .btn.advanced {
        background: #9b59b6;
        color: white;
      }
      
      .btn.advanced:hover {
        background: #8e44ad;
      }
      
      .btn.zero {
        grid-column: span 2;
      }
      
      .btn.equals {
        grid-row: span 2;
      }
      
      /* Scientific Calculator Styles */
      .scientific-calculator {
        max-width: 600px;
        margin: 0 auto;
      }
      
      .scientific-buttons {
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 10px;
        margin-top: 20px;
      }
      
      .scientific-btn {
        background: #ecf0f1;
        border: none;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 500;
        padding: 15px 10px;
        cursor: pointer;
        transition: all 0.2s ease;
        color: #2c3e50;
      }
      
      .scientific-btn:hover {
        background: #d5dbdb;
      }
      
      .scientific-btn.function {
        background: #e67e22;
        color: white;
      }
      
      .scientific-btn.function:hover {
        background: #d35400;
      }
      
      /* Graphing Calculator Styles */
      .graphing-container {
        display: flex;
        gap: 20px;
        height: 100%;
      }
      
      .graph-area {
        flex: 1;
        background: white;
        border: 1px solid #e1e1e1;
        border-radius: 8px;
        position: relative;
        min-height: 400px;
      }
      
      .graph-controls {
        width: 300px;
        display: flex;
        flex-direction: column;
        gap: 20px;
      }
      
      .function-input {
        background: #f8f9fa;
        border: 1px solid #e1e1e1;
        border-radius: 8px;
        padding: 20px;
      }
      
      .function-field {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 10px;
      }
      
      .function-label {
        background: #0078d4;
        color: white;
        padding: 8px 12px;
        border-radius: 4px;
        font-size: 0.9rem;
        font-weight: 500;
        min-width: 40px;
        text-align: center;
      }
      
      .function-input-field {
        flex: 1;
        padding: 8px 12px;
        border: 1px solid #d1d1d1;
        border-radius: 4px;
        font-size: 1rem;
      }
      
      .graph-keypad {
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: 8px;
      }
      
      .graph-btn {
        background: #f8f9fa;
        border: 1px solid #e1e1e1;
        border-radius: 4px;
        padding: 12px 8px;
        cursor: pointer;
        font-size: 0.9rem;
        transition: background-color 0.2s;
      }
      
      .graph-btn:hover {
        background: #e9ecef;
      }
      
      /* Converter Styles */
      .converter-container {
        max-width: 600px;
        margin: 0 auto;
      }
      
      .converter-header {
        text-align: center;
        margin-bottom: 30px;
      }
      
      .converter-title {
        font-size: 2rem;
        font-weight: 600;
        color: #323130;
        margin-bottom: 10px;
      }
      
      .conversion-grid {
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        gap: 20px;
        align-items: center;
      }
      
      .conversion-unit {
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      
      .unit-input {
        padding: 15px;
        border: 2px solid #e1e1e1;
        border-radius: 8px;
        font-size: 1.2rem;
        text-align: right;
      }
      
      .unit-input:focus {
        outline: none;
        border-color: #0078d4;
      }
      
      .unit-select {
        padding: 12px;
        border: 2px solid #e1e1e1;
        border-radius: 8px;
        font-size: 1rem;
        background: white;
      }
      
      .unit-select:focus {
        outline: none;
        border-color: #0078d4;
      }
      
      .conversion-arrow {
        font-size: 2rem;
        color: #0078d4;
        text-align: center;
      }
      
      /* Programmer Calculator Styles */
      .programmer-container {
        max-width: 800px;
        margin: 0 auto;
      }
      
      .number-base-selector {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        justify-content: center;
      }
      
      .base-btn {
        padding: 10px 20px;
        border: 2px solid #e1e1e1;
        background: white;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.2s;
      }
      
      .base-btn.active {
        background: #0078d4;
        color: white;
        border-color: #0078d4;
      }
      
      .programmer-display {
        background: #1e1e1e;
        color: #00ff00;
        font-family: 'Courier New', monospace;
        font-size: 1.5rem;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 20px;
        text-align: right;
        min-height: 80px;
        display: flex;
        align-items: center;
        justify-content: flex-end;
      }
      
      .programmer-buttons {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 10px;
      }
      
      .programmer-btn {
        background: #f8f9fa;
        border: 1px solid #e1e1e1;
        border-radius: 6px;
        padding: 15px 10px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 500;
        transition: background-color 0.2s;
      }
      
      .programmer-btn:hover {
        background: #e9ecef;
      }
      
      .programmer-btn.operation {
        background: #0078d4;
        color: white;
      }
      
      .programmer-btn.operation:hover {
        background: #106ebe;
      }
      
      /* Date Calculator Styles */
      .date-calculator {
        max-width: 600px;
        margin: 0 auto;
      }
      
      .date-input-group {
        display: flex;
        gap: 20px;
        margin-bottom: 30px;
      }
      
      .date-input {
        flex: 1;
        padding: 15px;
        border: 2px solid #e1e1e1;
        border-radius: 8px;
        font-size: 1rem;
      }
      
      .date-input:focus {
        outline: none;
        border-color: #0078d4;
      }
      
      .date-operation {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        justify-content: center;
      }
      
      .operation-btn {
        padding: 12px 24px;
        border: 2px solid #0078d4;
        background: white;
        color: #0078d4;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.2s;
      }
      
      .operation-btn:hover {
        background: #0078d4;
        color: white;
      }
      
      .date-result {
        background: #f8f9fa;
        border: 1px solid #e1e1e1;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        font-size: 1.2rem;
        font-weight: 600;
        color: #323130;
      }
      
      /* History and Memory Panels */
      .history-memory-panel {
        width: 300px;
        background: #f8f9fa;
        border-left: 1px solid #e1e1e1;
        display: flex;
        flex-direction: column;
      }
      
      .panel-tabs {
        display: flex;
        border-bottom: 1px solid #e1e1e1;
      }
      
      .panel-tab {
        flex: 1;
        padding: 15px;
        background: transparent;
        border: none;
        cursor: pointer;
        font-weight: 500;
        border-bottom: 3px solid transparent;
        transition: all 0.2s;
      }
      
      .panel-tab.active {
        background: white;
        border-bottom-color: #0078d4;
        color: #0078d4;
      }
      
      .panel-content {
        flex: 1;
        padding: 20px;
        overflow-y: auto;
      }
      
      .history-item, .memory-item {
        padding: 12px;
        margin-bottom: 8px;
        background: white;
        border-radius: 8px;
        border-left: 4px solid #0078d4;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      }
      
      .history-expression {
        font-size: 1rem;
        color: #323130;
        margin-bottom: 4px;
      }
      
      .history-result {
        font-size: 1.2rem;
        font-weight: 600;
        color: #e74c3c;
      }
      
      .memory-value {
        font-size: 1.1rem;
        font-weight: 600;
        color: #323130;
        margin-bottom: 4px;
      }
      
      .memory-timestamp {
        font-size: 0.8rem;
        color: #6c757d;
      }
      
      .clear-btn {
        background: #dc3545;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.9rem;
        margin-top: 15px;
        width: 100%;
      }
      
      .clear-btn:hover {
        background: #c82333;
      }
      
      .empty-state {
        text-align: center;
        color: #6c757d;
        font-style: italic;
        padding: 40px 20px;
      }
      
      /* Responsive Design */
      @media (max-width: 768px) {
        body {
          flex-direction: column;
        }
        
        .sidebar {
          width: 100%;
          height: auto;
          max-height: 200px;
        }
        
        .main-content {
          height: calc(100vh - 200px);
        }
        
        .graphing-container {
          flex-direction: column;
        }
        
        .graph-controls {
          width: 100%;
        }
        
        .conversion-grid {
          grid-template-columns: 1fr;
          gap: 15px;
        }
        
        .conversion-arrow {
          transform: rotate(90deg);
        }
      }
    </style>
  </head>
  <body>
    <!-- Sidebar Navigation -->
    <div class="sidebar">
      <div class="sidebar-header">
        <div class="hamburger">
          <span></span>
          <span></span>
          <span></span>
        </div>
        <div class="sidebar-title">Calculator</div>
      </div>
      
      <div class="nav-section">
        <div class="nav-title">Calculator</div>
        <div class="nav-item active" onclick="setMode('standard')">
          <div class="nav-icon">🧮</div>
          <div class="nav-text">Standard</div>
        </div>
        <div class="nav-item" onclick="setMode('scientific')">
          <div class="nav-icon">🔬</div>
          <div class="nav-text">Scientific</div>
        </div>
        <div class="nav-item" onclick="setMode('graphing')">
          <div class="nav-icon">📈</div>
          <div class="nav-text">Graphing</div>
        </div>
        <div class="nav-item" onclick="setMode('programmer')">
          <div class="nav-icon">&lt;/&gt;</div>
          <div class="nav-text">Programmer</div>
        </div>
        <div class="nav-item" onclick="setMode('date')">
          <div class="nav-icon">📅</div>
          <div class="nav-text">Date calculation</div>
        </div>
      </div>
      
      <div class="nav-section">
        <div class="nav-title">Converter</div>
        <div class="nav-item" onclick="setMode('currency')">
          <div class="nav-icon">∞</div>
          <div class="nav-text">Currency</div>
        </div>
        <div class="nav-item" onclick="setMode('volume')">
          <div class="nav-icon">📦</div>
          <div class="nav-text">Volume</div>
        </div>
        <div class="nav-item" onclick="setMode('length')">
          <div class="nav-icon">📏</div>
          <div class="nav-text">Length</div>
        </div>
        <div class="nav-item" onclick="setMode('weight')">
          <div class="nav-icon">⚖️</div>
          <div class="nav-text">Weight and mass</div>
        </div>
        <div class="nav-item" onclick="setMode('temperature')">
          <div class="nav-icon">🌡️</div>
          <div class="nav-text">Temperature</div>
        </div>
        <div class="nav-item" onclick="setMode('energy')">
          <div class="nav-icon">⚡</div>
          <div class="nav-text">Energy</div>
        </div>
        <div class="nav-item" onclick="setMode('area')">
          <div class="nav-icon">⊞</div>
          <div class="nav-text">Area</div>
        </div>
        <div class="nav-item" onclick="setMode('speed')">
          <div class="nav-icon">🏃</div>
          <div class="nav-text">Speed</div>
        </div>
        <div class="nav-item" onclick="setMode('time')">
          <div class="nav-icon">⏰</div>
          <div class="nav-text">Time</div>
        </div>
        <div class="nav-item" onclick="setMode('power')">
          <div class="nav-icon">⚡</div>
          <div class="nav-text">Power</div>
        </div>
        <div class="nav-item" onclick="setMode('data')">
          <div class="nav-icon">📄</div>
          <div class="nav-text">Data</div>
        </div>
        <div class="nav-item" onclick="setMode('pressure')">
          <div class="nav-icon">📊</div>
          <div class="nav-text">Pressure</div>
        </div>
        <div class="nav-item" onclick="setMode('angle')">
          <div class="nav-icon">∠</div>
          <div class="nav-text">Angle</div>
        </div>
      </div>
      
      <div class="nav-section">
        <div class="nav-item" onclick="setMode('settings')">
          <div class="nav-icon">⚙️</div>
          <div class="nav-text">Settings</div>
        </div>
      </div>
    </div>
    
    <!-- Main Content Area -->
    <div class="main-content">
      <div class="content-header">
        <div class="mode-title" id="mode-title">Standard</div>
      </div>
      
      <div class="content-body">
        <!-- Standard Calculator -->
        <div id="standard-calculator" class="calculator-container">
          <div class="display" id="display">0</div>
          
          <div class="memory-controls">
            <button class="memory-btn" onclick="memoryClear()">MC</button>
            <button class="memory-btn" onclick="memoryRecall()">MR</button>
            <button class="memory-btn" onclick="memoryAdd()">M+</button>
            <button class="memory-btn" onclick="memorySubtract()">M-</button>
            <button class="memory-btn" onclick="memoryStore()">MS</button>
          </div>
          
          <div class="buttons">
            <button class="btn clear" onclick="clearAll()">C</button>
            <button class="btn clear" onclick="clearEntry()">CE</button>
            <button class="btn clear" onclick="deleteLast()">⌫</button>
            <button class="btn operator" onclick="setOperator('/')">÷</button>
            
            <button class="btn" onclick="appendToDisplay('7')">7</button>
            <button class="btn" onclick="appendToDisplay('8')">8</button>
            <button class="btn" onclick="appendToDisplay('9')">9</button>
            <button class="btn operator" onclick="setOperator('*')">×</button>
            
            <button class="btn" onclick="appendToDisplay('4')">4</button>
            <button class="btn" onclick="appendToDisplay('5')">5</button>
            <button class="btn" onclick="appendToDisplay('6')">6</button>
            <button class="btn operator" onclick="setOperator('-')">-</button>
            
            <button class="btn" onclick="appendToDisplay('1')">1</button>
            <button class="btn" onclick="appendToDisplay('2')">2</button>
            <button class="btn" onclick="appendToDisplay('3')">3</button>
            <button class="btn operator" onclick="setOperator('+')">+</button>
            
            <button class="btn zero" onclick="appendToDisplay('0')">0</button>
            <button class="btn" onclick="appendToDisplay('.')">.</button>
            <button class="btn equals" onclick="calculate()">=</button>
            
            <!-- Advanced Operations Row -->
            <button class="btn advanced" onclick="percentage()">%</button>
            <button class="btn advanced" onclick="squareRoot()">√</button>
            <button class="btn advanced" onclick="square()">x²</button>
            <button class="btn advanced" onclick="toggleSign()">±</button>
          </div>
        </div>
        
        <!-- Scientific Calculator -->
        <div id="scientific-calculator" class="scientific-calculator" style="display: none;">
          <div class="display" id="scientific-display">0</div>
          
          <div class="scientific-buttons">
            <button class="scientific-btn function" onclick="scientificFunction('sin')">sin</button>
            <button class="scientific-btn function" onclick="scientificFunction('cos')">cos</button>
            <button class="scientific-btn function" onclick="scientificFunction('tan')">tan</button>
            <button class="scientific-btn function" onclick="scientificFunction('log')">log</button>
            <button class="scientific-btn function" onclick="scientificFunction('ln')">ln</button>
            
            <button class="scientific-btn" onclick="appendToDisplay('(')">(</button>
            <button class="scientific-btn" onclick="appendToDisplay(')')">)</button>
            <button class="scientific-btn" onclick="appendToDisplay('π')">π</button>
            <button class="scientific-btn" onclick="appendToDisplay('e')">e</button>
            <button class="scientific-btn" onclick="clearAll()">C</button>
            
            <button class="scientific-btn" onclick="appendToDisplay('7')">7</button>
            <button class="scientific-btn" onclick="appendToDisplay('8')">8</button>
            <button class="scientific-btn" onclick="appendToDisplay('9')">9</button>
            <button class="scientific-btn operator" onclick="setOperator('/')">÷</button>
            <button class="scientific-btn" onclick="scientificFunction('sqrt')">√</button>
            
            <button class="scientific-btn" onclick="appendToDisplay('4')">4</button>
            <button class="scientific-btn" onclick="appendToDisplay('5')">5</button>
            <button class="scientific-btn" onclick="appendToDisplay('6')">6</button>
            <button class="scientific-btn operator" onclick="setOperator('*')">×</button>
            <button class="scientific-btn" onclick="scientificFunction('pow')">x^y</button>
            
            <button class="scientific-btn" onclick="appendToDisplay('1')">1</button>
            <button class="scientific-btn" onclick="appendToDisplay('2')">2</button>
            <button class="scientific-btn" onclick="appendToDisplay('3')">3</button>
            <button class="scientific-btn operator" onclick="setOperator('-')">-</button>
            <button class="scientific-btn" onclick="scientificFunction('factorial')">n!</button>
            
            <button class="scientific-btn" onclick="appendToDisplay('0')">0</button>
            <button class="scientific-btn" onclick="appendToDisplay('.')">.</button>
            <button class="scientific-btn" onclick="toggleSign()">±</button>
            <button class="scientific-btn operator" onclick="setOperator('+')">+</button>
            <button class="scientific-btn equals" onclick="calculate()">=</button>
          </div>
        </div>
        
        <!-- Graphing Calculator -->
        <div id="graphing-calculator" class="graphing-container" style="display: none;">
          <div class="graph-area" id="graph-area">
            <canvas id="graph-canvas" width="600" height="400"></canvas>
          </div>
          <div class="graph-controls">
            <div class="function-input">
              <div class="function-field">
                <div class="function-label">f₁</div>
                <input type="text" class="function-input-field" id="function-input" placeholder="Enter an expression">
              </div>
              <div class="function-field">
                <div class="function-label">f</div>
                <input type="text" class="function-input-field" placeholder="Enter an expression">
              </div>
            </div>
            <div class="graph-keypad">
              <button class="graph-btn" onclick="appendToGraph('sin(')">sin</button>
              <button class="graph-btn" onclick="appendToGraph('cos(')">cos</button>
              <button class="graph-btn" onclick="appendToGraph('tan(')">tan</button>
              <button class="graph-btn" onclick="appendToGraph('log(')">log</button>
              <button class="graph-btn" onclick="appendToGraph('ln(')">ln</button>
              
              <button class="graph-btn" onclick="appendToGraph('(')">(</button>
              <button class="graph-btn" onclick="appendToGraph(')')">)</button>
              <button class="graph-btn" onclick="appendToGraph('π')">π</button>
              <button class="graph-btn" onclick="appendToGraph('e')">e</button>
              <button class="graph-btn" onclick="clearGraph()">C</button>
              
              <button class="graph-btn" onclick="appendToGraph('x^2')">x²</button>
              <button class="graph-btn" onclick="appendToGraph('1/x')">1/x</button>
              <button class="graph-btn" onclick="appendToGraph('|x|')">|x|</button>
              <button class="graph-btn" onclick="appendToGraph('x')">x</button>
              <button class="graph-btn" onclick="appendToGraph('y')">y</button>
              
              <button class="graph-btn" onclick="appendToGraph('x^(1/3)')">∛x</button>
              <button class="graph-btn" onclick="appendToGraph('(')">(</button>
              <button class="graph-btn" onclick="appendToGraph(')')">)</button>
              <button class="graph-btn" onclick="appendToGraph('=')">=</button>
              <button class="graph-btn" onclick="appendToGraph('/')">÷</button>
              
              <button class="graph-btn" onclick="appendToGraph('x^y')">x^y</button>
              <button class="graph-btn" onclick="appendToGraph('7')">7</button>
              <button class="graph-btn" onclick="appendToGraph('8')">8</button>
              <button class="graph-btn" onclick="appendToGraph('9')">9</button>
              <button class="graph-btn" onclick="appendToGraph('*')">×</button>
              
              <button class="graph-btn" onclick="appendToGraph('10^x')">10^x</button>
              <button class="graph-btn" onclick="appendToGraph('4')">4</button>
              <button class="graph-btn" onclick="appendToGraph('5')">5</button>
              <button class="graph-btn" onclick="appendToGraph('6')">6</button>
              <button class="graph-btn" onclick="appendToGraph('-')">-</button>
              
              <button class="graph-btn" onclick="appendToGraph('log(')">log</button>
              <button class="graph-btn" onclick="appendToGraph('1')">1</button>
              <button class="graph-btn" onclick="appendToGraph('2')">2</button>
              <button class="graph-btn" onclick="appendToGraph('3')">3</button>
              <button class="graph-btn" onclick="appendToGraph('+')">+</button>
              
              <button class="graph-btn" onclick="appendToGraph('ln(')">ln</button>
              <button class="graph-btn" onclick="appendToGraph('±')">±</button>
              <button class="graph-btn" onclick="appendToGraph('0')">0</button>
              <button class="graph-btn" onclick="appendToGraph('.')">.</button>
              <button class="graph-btn" onclick="plotFunction()">↵</button>
            </div>
          </div>
        </div>
        
        <!-- Programmer Calculator -->
        <div id="programmer-calculator" class="programmer-container" style="display: none;">
          <div class="number-base-selector">
            <button class="base-btn active" onclick="setBase('hex')">HEX</button>
            <button class="base-btn" onclick="setBase('dec')">DEC</button>
            <button class="base-btn" onclick="setBase('oct')">OCT</button>
            <button class="base-btn" onclick="setBase('bin')">BIN</button>
          </div>
          
          <div class="programmer-display" id="programmer-display">0</div>
          
          <div class="programmer-buttons">
            <button class="programmer-btn" onclick="programmerInput('A')">A</button>
            <button class="programmer-btn" onclick="programmerInput('B')">B</button>
            <button class="programmer-btn" onclick="programmerInput('C')">C</button>
            <button class="programmer-btn" onclick="programmerInput('D')">D</button>
            <button class="programmer-btn" onclick="programmerInput('E')">E</button>
            <button class="programmer-btn" onclick="programmerInput('F')">F</button>
            
            <button class="programmer-btn" onclick="programmerInput('7')">7</button>
            <button class="programmer-btn" onclick="programmerInput('8')">8</button>
            <button class="programmer-btn" onclick="programmerInput('9')">9</button>
            <button class="programmer-btn operation" onclick="setOperator('&')">AND</button>
            <button class="programmer-btn operation" onclick="setOperator('|')">OR</button>
            <button class="programmer-btn operation" onclick="setOperator('^')">XOR</button>
            
            <button class="programmer-btn" onclick="programmerInput('4')">4</button>
            <button class="programmer-btn" onclick="programmerInput('5')">5</button>
            <button class="programmer-btn" onclick="programmerInput('6')">6</button>
            <button class="programmer-btn operation" onclick="setOperator('<<')">Lsh</button>
            <button class="programmer-btn operation" onclick="setOperator('>>')">Rsh</button>
            <button class="programmer-btn operation" onclick="setOperator('~')">NOT</button>
            
            <button class="programmer-btn" onclick="programmerInput('1')">1</button>
            <button class="programmer-btn" onclick="programmerInput('2')">2</button>
            <button class="programmer-btn" onclick="programmerInput('3')">3</button>
            <button class="programmer-btn operation" onclick="setOperator('+')">+</button>
            <button class="programmer-btn operation" onclick="setOperator('-')">-</button>
            <button class="programmer-btn operation" onclick="setOperator('*')">×</button>
            
            <button class="programmer-btn" onclick="programmerInput('0')">0</button>
            <button class="programmer-btn" onclick="clearAll()">C</button>
            <button class="programmer-btn" onclick="deleteLast()">⌫</button>
            <button class="programmer-btn operation" onclick="setOperator('/')">÷</button>
            <button class="programmer-btn operation" onclick="setOperator('%')">Mod</button>
            <button class="programmer-btn equals" onclick="calculate()">=</button>
          </div>
        </div>
        
        <!-- Date Calculator -->
        <div id="date-calculator" class="date-calculator" style="display: none;">
          <div class="date-input-group">
            <input type="date" class="date-input" id="date1">
            <input type="date" class="date-input" id="date2">
          </div>
          
          <div class="date-operation">
            <button class="operation-btn" onclick="calculateDateDifference()">Calculate Difference</button>
            <button class="operation-btn" onclick="addDaysToDate()">Add Days</button>
            <button class="operation-btn" onclick="subtractDaysFromDate()">Subtract Days</button>
          </div>
          
          <div class="date-result" id="date-result">
            Select dates and operation to see result
          </div>
        </div>
        
        <!-- Converter Templates -->
        <div id="converter-template" style="display: none;">
          <div class="converter-container">
            <div class="converter-header">
              <div class="converter-title" id="converter-title">Converter</div>
            </div>
            
            <div class="conversion-grid">
              <div class="conversion-unit">
                <input type="number" class="unit-input" id="from-value" placeholder="0">
                <select class="unit-select" id="from-unit"></select>
              </div>
              
              <div class="conversion-arrow">⇄</div>
              
              <div class="conversion-unit">
                <input type="number" class="unit-input" id="to-value" placeholder="0" readonly>
                <select class="unit-select" id="to-unit"></select>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- History and Memory Panel -->
    <div class="history-memory-panel">
      <div class="panel-tabs">
        <button class="panel-tab active" onclick="showPanel('history')">History</button>
        <button class="panel-tab" onclick="showPanel('memory')">Memory</button>
      </div>
      
      <div class="panel-content">
        <div id="history-panel">
          <div id="history-list"></div>
          <button class="clear-btn" onclick="clearHistory()">Clear History</button>
        </div>
        
        <div id="memory-panel" style="display: none;">
          <div id="memory-list"></div>
          <button class="clear-btn" onclick="clearMemory()">Clear Memory</button>
        </div>
      </div>
    </div>

    <script>
      // Enhanced Calculator with All Modes and Converters
      class UniversalCalculator {
        constructor() {
          this.currentMode = 'standard';
          this.currentInput = '0';
          this.operator = null;
          this.previousInput = null;
          this.shouldResetDisplay = false;
          this.history = this.loadHistory();
          this.memory = this.loadMemory();
          this.currentBase = 'dec';
          this.conversionRates = this.loadConversionRates();
        }

        // Mode Management
        setMode(mode) {
          this.currentMode = mode;
          
          // Update navigation
          document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
          event.target.classList.add('active');
          
          // Update title
          document.getElementById('mode-title').textContent = this.getModeTitle(mode);
          
          // Show/hide appropriate content
          this.showModeContent(mode);
          
          // Initialize mode-specific functionality
          this.initializeMode(mode);
        }

        getModeTitle(mode) {
          const titles = {
            'standard': 'Standard',
            'scientific': 'Scientific',
            'graphing': 'Graphing',
            'programmer': 'Programmer',
            'date': 'Date calculation',
            'currency': 'Currency',
            'volume': 'Volume',
            'length': 'Length',
            'weight': 'Weight and mass',
            'temperature': 'Temperature',
            'energy': 'Energy',
            'area': 'Area',
            'speed': 'Speed',
            'time': 'Time',
            'power': 'Power',
            'data': 'Data',
            'pressure': 'Pressure',
            'angle': 'Angle',
            'settings': 'Settings'
          };
          return titles[mode] || mode;
        }

        showModeContent(mode) {
          // Hide all calculator modes
          const modes = ['standard', 'scientific', 'graphing', 'programmer', 'date'];
          modes.forEach(m => {
            const element = document.getElementById(m + '-calculator');
            if (element) element.style.display = 'none';
          });

          // Show converter template if it's a converter mode
          const converterTemplate = document.getElementById('converter-template');
          if (this.isConverterMode(mode)) {
            converterTemplate.style.display = 'block';
            this.setupConverter(mode);
          } else {
            converterTemplate.style.display = 'none';
            if (modes.includes(mode)) {
              const element = document.getElementById(mode + '-calculator');
              if (element) element.style.display = 'block';
            }
          }
        }

        isConverterMode(mode) {
          const converterModes = ['currency', 'volume', 'length', 'weight', 'temperature', 
                                'energy', 'area', 'speed', 'time', 'power', 'data', 'pressure', 'angle'];
          return converterModes.includes(mode);
        }

        initializeMode(mode) {
          switch(mode) {
            case 'graphing':
              this.initializeGraphing();
              break;
            case 'programmer':
              this.initializeProgrammer();
              break;
            case 'date':
              this.initializeDateCalculator();
              break;
          }
        }

        // Standard Calculator Functions
        updateDisplay() {
          const display = document.getElementById('display');
          if (this.operator && this.previousInput !== null) {
            const operatorSymbol = this.operator === '*' ? '×' : this.operator === '/' ? '÷' : this.operator;
            display.textContent = `${this.previousInput} ${operatorSymbol} ${this.currentInput}`;
          } else {
            display.textContent = this.currentInput;
          }
        }

        appendToDisplay(value) {
          if (this.shouldResetDisplay) {
            this.currentInput = '';
            this.shouldResetDisplay = false;
          }

          if (value === '.' && this.currentInput.includes('.')) {
            return;
          }

          if (this.currentInput === '0' && value !== '.') {
            this.currentInput = value;
          } else {
            this.currentInput += value;
          }

          this.updateDisplay();
        }

        clearAll() {
          this.currentInput = '0';
          this.operator = null;
          this.previousInput = null;
          this.shouldResetDisplay = false;
          this.updateDisplay();
        }

        clearEntry() {
          this.currentInput = '0';
          this.updateDisplay();
        }

        deleteLast() {
          if (this.currentInput.length > 1) {
            this.currentInput = this.currentInput.slice(0, -1);
          } else {
            this.currentInput = '0';
          }
          this.updateDisplay();
        }

        setOperator(op) {
          if (this.operator && this.previousInput !== null) {
            this.calculate();
          }
          
          this.operator = op;
          this.previousInput = this.currentInput;
          this.shouldResetDisplay = true;
          this.updateDisplay();
        }

        calculate() {
          if (this.operator && this.previousInput !== null) {
            const prev = parseFloat(this.previousInput);
            const current = parseFloat(this.currentInput);
            let result;

            switch (this.operator) {
              case '+':
                result = prev + current;
                break;
              case '-':
                result = prev - current;
                break;
              case '*':
                result = prev * current;
                break;
              case '/':
                if (current === 0) {
                  alert('Cannot divide by zero!');
                  return;
                }
                result = prev / current;
                break;
              default:
                return;
            }

            const operatorSymbol = this.operator === '*' ? '×' : this.operator === '/' ? '÷' : this.operator;
            const expression = `${this.previousInput} ${operatorSymbol} ${this.currentInput}`;
            
            this.addToHistory(expression, result);
            
            this.currentInput = this.formatResult(result);
            this.operator = null;
            this.previousInput = null;
            this.shouldResetDisplay = true;
            this.updateDisplay();
          }
        }

        formatResult(result) {
          if (Math.abs(result) > 1e10 || (Math.abs(result) < 1e-6 && result !== 0)) {
            return result.toExponential(6).replace(/\.?0+e/, 'e');
          }
          return parseFloat(result.toPrecision(12)).toString();
        }

        // Advanced Operations
        percentage() {
          const value = parseFloat(this.currentInput);
          const result = value / 100;
          this.addToHistory(`${this.currentInput}%`, result);
          this.currentInput = result.toString();
          this.shouldResetDisplay = true;
          this.updateDisplay();
        }

        squareRoot() {
          const value = parseFloat(this.currentInput);
          if (value < 0) {
            alert('Cannot calculate square root of negative number!');
            return;
          }
          const result = Math.sqrt(value);
          this.addToHistory(`√${this.currentInput}`, result);
          this.currentInput = this.formatResult(result);
          this.shouldResetDisplay = true;
          this.updateDisplay();
        }

        square() {
          const value = parseFloat(this.currentInput);
          const result = value * value;
          this.addToHistory(`${this.currentInput}²`, result);
          this.currentInput = result.toString();
          this.shouldResetDisplay = true;
          this.updateDisplay();
        }

        toggleSign() {
          if (this.currentInput !== '0') {
            this.currentInput = this.currentInput.startsWith('-') 
              ? this.currentInput.slice(1) 
              : '-' + this.currentInput;
            this.updateDisplay();
          }
        }

        // Scientific Calculator Functions
        scientificFunction(func) {
          const value = parseFloat(this.currentInput);
          let result;

          switch(func) {
            case 'sin':
              result = Math.sin(value * Math.PI / 180);
              break;
            case 'cos':
              result = Math.cos(value * Math.PI / 180);
              break;
            case 'tan':
              result = Math.tan(value * Math.PI / 180);
              break;
            case 'log':
              result = Math.log10(value);
              break;
            case 'ln':
              result = Math.log(value);
              break;
            case 'sqrt':
              result = Math.sqrt(value);
              break;
            case 'pow':
              // This would need a second input
              break;
            case 'factorial':
              result = this.factorial(Math.floor(value));
              break;
          }

          if (result !== undefined) {
            this.addToHistory(`${func}(${this.currentInput})`, result);
            this.currentInput = this.formatResult(result);
            this.shouldResetDisplay = true;
            this.updateDisplay();
          }
        }

        factorial(n) {
          if (n < 0) return NaN;
          if (n === 0 || n === 1) return 1;
          let result = 1;
          for (let i = 2; i <= n; i++) {
            result *= i;
          }
          return result;
        }

        // Programmer Calculator Functions
        setBase(base) {
          this.currentBase = base;
          document.querySelectorAll('.base-btn').forEach(btn => btn.classList.remove('active'));
          event.target.classList.add('active');
          this.updateProgrammerDisplay();
        }

        programmerInput(value) {
          // Validate input based on current base
          if (this.isValidInput(value)) {
            this.appendToDisplay(value);
            this.updateProgrammerDisplay();
          }
        }

        isValidInput(value) {
          const validChars = {
            'bin': ['0', '1'],
            'oct': ['0', '1', '2', '3', '4', '5', '6', '7'],
            'dec': ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'],
            'hex': ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F']
          };
          return validChars[this.currentBase].includes(value.toUpperCase());
        }

        updateProgrammerDisplay() {
          const display = document.getElementById('programmer-display');
          display.textContent = this.currentInput;
        }

        // Graphing Calculator Functions
        initializeGraphing() {
          const canvas = document.getElementById('graph-canvas');
          if (canvas) {
            this.drawGraph();
          }
        }

        drawGraph() {
          const canvas = document.getElementById('graph-canvas');
          const ctx = canvas.getContext('2d');
          
          // Clear canvas
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          
          // Draw axes
          ctx.strokeStyle = '#ccc';
          ctx.lineWidth = 1;
          
          // X-axis
          ctx.beginPath();
          ctx.moveTo(0, canvas.height / 2);
          ctx.lineTo(canvas.width, canvas.height / 2);
          ctx.stroke();
          
          // Y-axis
          ctx.beginPath();
          ctx.moveTo(canvas.width / 2, 0);
          ctx.lineTo(canvas.width / 2, canvas.height);
          ctx.stroke();
          
          // Draw grid
          ctx.strokeStyle = '#f0f0f0';
          for (let i = 0; i < canvas.width; i += 20) {
            ctx.beginPath();
            ctx.moveTo(i, 0);
            ctx.lineTo(i, canvas.height);
            ctx.stroke();
          }
          for (let i = 0; i < canvas.height; i += 20) {
            ctx.beginPath();
            ctx.moveTo(0, i);
            ctx.lineTo(canvas.width, i);
            ctx.stroke();
          }
        }

        appendToGraph(value) {
          const input = document.getElementById('function-input');
          input.value += value;
        }

        clearGraph() {
          const input = document.getElementById('function-input');
          input.value = '';
        }

        plotFunction() {
          const input = document.getElementById('function-input');
          const expression = input.value;
          
          if (expression) {
            this.drawFunction(expression);
          }
        }

        drawFunction(expression) {
          const canvas = document.getElementById('graph-canvas');
          const ctx = canvas.getContext('2d');
          
          ctx.strokeStyle = '#0078d4';
          ctx.lineWidth = 2;
          ctx.beginPath();
          
          let firstPoint = true;
          
          for (let x = -10; x <= 10; x += 0.1) {
            try {
              const y = this.evaluateExpression(expression.replace(/x/g, x));
              if (!isNaN(y) && isFinite(y)) {
                const pixelX = (x + 10) * (canvas.width / 20);
                const pixelY = canvas.height - (y + 10) * (canvas.height / 20);
                
                if (firstPoint) {
                  ctx.moveTo(pixelX, pixelY);
                  firstPoint = false;
                } else {
                  ctx.lineTo(pixelX, pixelY);
                }
              }
            } catch (e) {
              // Skip invalid points
            }
          }
          
          ctx.stroke();
        }

        evaluateExpression(expression) {
          // Simple expression evaluator
          // This is a basic implementation - in production, use a proper math parser
          return Function('"use strict"; return (' + expression + ')')();
        }

        // Date Calculator Functions
        initializeDateCalculator() {
          const today = new Date().toISOString().split('T')[0];
          document.getElementById('date1').value = today;
          document.getElementById('date2').value = today;
        }

        calculateDateDifference() {
          const date1 = new Date(document.getElementById('date1').value);
          const date2 = new Date(document.getElementById('date2').value);
          
          const diffTime = Math.abs(date2 - date1);
          const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
          
          document.getElementById('date-result').textContent = 
            `Difference: ${diffDays} days`;
        }

        addDaysToDate() {
          const date1 = new Date(document.getElementById('date1').value);
          const days = prompt('Enter number of days to add:');
          
          if (days && !isNaN(days)) {
            date1.setDate(date1.getDate() + parseInt(days));
            document.getElementById('date-result').textContent = 
              `Result: ${date1.toLocaleDateString()}`;
          }
        }

        subtractDaysFromDate() {
          const date1 = new Date(document.getElementById('date1').value);
          const days = prompt('Enter number of days to subtract:');
          
          if (days && !isNaN(days)) {
            date1.setDate(date1.getDate() - parseInt(days));
            document.getElementById('date-result').textContent = 
              `Result: ${date1.toLocaleDateString()}`;
          }
        }

        // Converter Functions
        setupConverter(mode) {
          const title = document.getElementById('converter-title');
          title.textContent = this.getModeTitle(mode);
          
          const fromUnit = document.getElementById('from-unit');
          const toUnit = document.getElementById('to-unit');
          
          // Clear existing options
          fromUnit.innerHTML = '';
          toUnit.innerHTML = '';
          
          // Get units for this converter
          const units = this.getConverterUnits(mode);
          
          // Populate unit selectors
          units.forEach(unit => {
            const option1 = document.createElement('option');
            option1.value = unit.value;
            option1.textContent = unit.label;
            fromUnit.appendChild(option1);
            
            const option2 = document.createElement('option');
            option2.value = unit.value;
            option2.textContent = unit.label;
            toUnit.appendChild(option2);
          });
          
          // Set up conversion listeners
          document.getElementById('from-value').addEventListener('input', () => this.convert(mode));
          fromUnit.addEventListener('change', () => this.convert(mode));
          toUnit.addEventListener('change', () => this.convert(mode));
        }

        getConverterUnits(mode) {
          const units = {
            'currency': [
              { value: 'USD', label: 'US Dollar (USD)' },
              { value: 'EUR', label: 'Euro (EUR)' },
              { value: 'GBP', label: 'British Pound (GBP)' },
              { value: 'JPY', label: 'Japanese Yen (JPY)' },
              { value: 'CAD', label: 'Canadian Dollar (CAD)' },
              { value: 'AUD', label: 'Australian Dollar (AUD)' }
            ],
            'length': [
              { value: 'mm', label: 'Millimeter (mm)' },
              { value: 'cm', label: 'Centimeter (cm)' },
              { value: 'm', label: 'Meter (m)' },
              { value: 'km', label: 'Kilometer (km)' },
              { value: 'in', label: 'Inch (in)' },
              { value: 'ft', label: 'Foot (ft)' },
              { value: 'yd', label: 'Yard (yd)' },
              { value: 'mi', label: 'Mile (mi)' }
            ],
            'weight': [
              { value: 'mg', label: 'Milligram (mg)' },
              { value: 'g', label: 'Gram (g)' },
              { value: 'kg', label: 'Kilogram (kg)' },
              { value: 'oz', label: 'Ounce (oz)' },
              { value: 'lb', label: 'Pound (lb)' },
              { value: 'ton', label: 'Ton (ton)' }
            ],
            'temperature': [
              { value: 'c', label: 'Celsius (°C)' },
              { value: 'f', label: 'Fahrenheit (°F)' },
              { value: 'k', label: 'Kelvin (K)' }
            ],
            'volume': [
              { value: 'ml', label: 'Milliliter (ml)' },
              { value: 'l', label: 'Liter (l)' },
              { value: 'floz', label: 'Fluid Ounce (fl oz)' },
              { value: 'cup', label: 'Cup (cup)' },
              { value: 'pt', label: 'Pint (pt)' },
              { value: 'qt', label: 'Quart (qt)' },
              { value: 'gal', label: 'Gallon (gal)' }
            ]
          };
          
          return units[mode] || [];
        }

        convert(mode) {
          const fromValue = parseFloat(document.getElementById('from-value').value) || 0;
          const fromUnit = document.getElementById('from-unit').value;
          const toUnit = document.getElementById('to-unit').value;
          
          if (fromUnit && toUnit) {
            const result = this.performConversion(fromValue, fromUnit, toUnit, mode);
            document.getElementById('to-value').value = this.formatResult(result);
          }
        }

        performConversion(value, fromUnit, toUnit, mode) {
          // This is a simplified conversion system
          // In production, you'd want a comprehensive conversion library
          
          const conversions = {
            'length': {
              'mm': 1,
              'cm': 10,
              'm': 1000,
              'km': 1000000,
              'in': 25.4,
              'ft': 304.8,
              'yd': 914.4,
              'mi': 1609344
            },
            'weight': {
              'mg': 1,
              'g': 1000,
              'kg': 1000000,
              'oz': 28349.5,
              'lb': 453592,
              'ton': 1000000000
            },
            'temperature': {
              'c': (val) => val,
              'f': (val) => (val - 32) * 5/9,
              'k': (val) => val - 273.15
            }
          };
          
          if (mode === 'temperature') {
            // Special handling for temperature
            const tempConversions = {
              'c': { 'f': (c) => c * 9/5 + 32, 'k': (c) => c + 273.15 },
              'f': { 'c': (f) => (f - 32) * 5/9, 'k': (f) => (f - 32) * 5/9 + 273.15 },
              'k': { 'c': (k) => k - 273.15, 'f': (k) => (k - 273.15) * 9/5 + 32 }
            };
            
            if (fromUnit === toUnit) return value;
            return tempConversions[fromUnit][toUnit](value);
          }
          
          // Standard conversions
          const conversionTable = conversions[mode];
          if (conversionTable && conversionTable[fromUnit] && conversionTable[toUnit]) {
            const baseValue = value * conversionTable[fromUnit];
            return baseValue / conversionTable[toUnit];
          }
          
          return value;
        }

        // Memory Functions
        memoryStore() {
          const value = parseFloat(this.currentInput);
          if (!isNaN(value)) {
            const timestamp = new Date();
            this.memory.push({
              value: value,
              timestamp: timestamp.toISOString(),
              timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
            });
            this.saveMemory();
            this.updateMemoryDisplay();
          }
        }

        memoryRecall() {
          if (this.memory.length > 0) {
            const lastMemory = this.memory[this.memory.length - 1];
            this.currentInput = lastMemory.value.toString();
            this.shouldResetDisplay = true;
            this.updateDisplay();
          }
        }

        memoryAdd() {
          if (this.memory.length > 0) {
            const value = parseFloat(this.currentInput);
            const lastMemory = this.memory[this.memory.length - 1];
            lastMemory.value += value;
            lastMemory.timestamp = new Date().toISOString();
            this.saveMemory();
            this.updateMemoryDisplay();
          }
        }

        memorySubtract() {
          if (this.memory.length > 0) {
            const value = parseFloat(this.currentInput);
            const lastMemory = this.memory[this.memory.length - 1];
            lastMemory.value -= value;
            lastMemory.timestamp = new Date().toISOString();
            this.saveMemory();
            this.updateMemoryDisplay();
          }
        }

        memoryClear() {
          this.memory = [];
          this.saveMemory();
          this.updateMemoryDisplay();
        }

        // History Management
        addToHistory(expression, result) {
          const timestamp = new Date();
          this.history.push({
            expression: expression,
            result: result,
            timestamp: timestamp.toISOString(),
            timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
          });
          this.saveHistory();
          this.updateHistoryDisplay();
        }

        clearHistory() {
          this.history = [];
          this.saveHistory();
          this.updateHistoryDisplay();
        }

        clearMemory() {
          this.memory = [];
          this.saveMemory();
          this.updateMemoryDisplay();
        }

        // Local Storage
        saveHistory() {
          localStorage.setItem('calculatorHistory', JSON.stringify(this.history));
        }

        loadHistory() {
          const saved = localStorage.getItem('calculatorHistory');
          return saved ? JSON.parse(saved) : [];
        }

        saveMemory() {
          localStorage.setItem('calculatorMemory', JSON.stringify(this.memory));
        }

        loadMemory() {
          const saved = localStorage.getItem('calculatorMemory');
          return saved ? JSON.parse(saved) : [];
        }

        loadConversionRates() {
          // In production, load from an API
          return {};
        }

        // Display Updates
        updateHistoryDisplay() {
          const historyList = document.getElementById('history-list');
          if (this.history.length === 0) {
            historyList.innerHTML = '<div class="empty-state">No calculations yet</div>';
            return;
          }

          historyList.innerHTML = this.history.slice(-10).reverse().map(item => `
            <div class="history-item">
              <div class="history-expression">${item.expression}</div>
              <div class="history-result">${this.formatResult(item.result)}</div>
              <div class="memory-timestamp">${this.formatTimestamp(item.timestamp, item.timezone)}</div>
            </div>
          `).join('');
        }

        updateMemoryDisplay() {
          const memoryList = document.getElementById('memory-list');
          if (this.memory.length === 0) {
            memoryList.innerHTML = '<div class="empty-state">No values stored in memory</div>';
            return;
          }

          memoryList.innerHTML = this.memory.slice(-10).reverse().map(item => `
            <div class="memory-item">
              <div class="memory-value">${this.formatResult(item.value)}</div>
              <div class="memory-timestamp">${this.formatTimestamp(item.timestamp, item.timezone)}</div>
            </div>
          `).join('');
        }

        formatTimestamp(timestamp, timezone) {
          const date = new Date(timestamp);
          return date.toLocaleString('en-US', {
            timeZone: timezone,
            year: 'numeric',
            month: 'short',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit',
            timeZoneName: 'short'
          });
        }
      }

      // Global calculator instance
      const calculator = new UniversalCalculator();

      // Global functions for HTML onclick handlers
      function setMode(mode) { calculator.setMode(mode); }
      function appendToDisplay(value) { calculator.appendToDisplay(value); }
      function clearAll() { calculator.clearAll(); }
      function clearEntry() { calculator.clearEntry(); }
      function deleteLast() { calculator.deleteLast(); }
      function setOperator(op) { calculator.setOperator(op); }
      function calculate() { calculator.calculate(); }
      function percentage() { calculator.percentage(); }
      function squareRoot() { calculator.squareRoot(); }
      function square() { calculator.square(); }
      function toggleSign() { calculator.toggleSign(); }
      function scientificFunction(func) { calculator.scientificFunction(func); }
      function setBase(base) { calculator.setBase(base); }
      function programmerInput(value) { calculator.programmerInput(value); }
      function appendToGraph(value) { calculator.appendToGraph(value); }
      function clearGraph() { calculator.clearGraph(); }
      function plotFunction() { calculator.plotFunction(); }
      function calculateDateDifference() { calculator.calculateDateDifference(); }
      function addDaysToDate() { calculator.addDaysToDate(); }
      function subtractDaysFromDate() { calculator.subtractDaysFromDate(); }
      function memoryStore() { calculator.memoryStore(); }
      function memoryRecall() { calculator.memoryRecall(); }
      function memoryAdd() { calculator.memoryAdd(); }
      function memorySubtract() { calculator.memorySubtract(); }
      function memoryClear() { calculator.memoryClear(); }
      function clearHistory() { calculator.clearHistory(); }
      function clearMemory() { calculator.clearMemory(); }

      // Panel Management
      function showPanel(panelName) {
        document.querySelectorAll('.panel-tab').forEach(tab => tab.classList.remove('active'));
        document.querySelectorAll('.panel-tab').forEach(tab => {
          if (tab.textContent.toLowerCase().includes(panelName)) {
            tab.classList.add('active');
          }
        });
        
        document.getElementById('history-panel').style.display = panelName === 'history' ? 'block' : 'none';
        document.getElementById('memory-panel').style.display = panelName === 'memory' ? 'block' : 'none';
        
        if (panelName === 'history') {
          calculator.updateHistoryDisplay();
        } else if (panelName === 'memory') {
          calculator.updateMemoryDisplay();
        }
      }

      // Keyboard Support
      document.addEventListener('keydown', function(event) {
        const key = event.key;
        
        if (key >= '0' && key <= '9' || key === '.') {
          appendToDisplay(key);
        } else if (['+', '-', '*', '/'].includes(key)) {
          setOperator(key);
        } else if (key === 'Enter' || key === '=') {
          event.preventDefault();
          calculate();
        } else if (key === 'Escape' || key === 'c' || key === 'C') {
          clearAll();
        } else if (key === 'Backspace') {
          deleteLast();
        }
      });

      // Initialize
      calculator.updateDisplay();
      calculator.updateHistoryDisplay();
      calculator.updateMemoryDisplay();
    </script>
  </body>
</html>